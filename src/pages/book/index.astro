---
import { getCollection } from "astro:content";
import type { BookPostType } from "./[...slug].astro";
import BaseLayout from "../../layouts/BaseLayout.astro";
import BookListItem from "../../components/list-item/BookListItem.astro";

const books: BookPostType[] = (await getCollection("book"))
  .filter(({ data }: BookPostType) => !data.draft)
  .sort(
    (a: BookPostType, b: BookPostType) =>
      a.data.finishedDate.valueOf() - b.data.finishedDate.valueOf(),
  )
  .reverse();
---

<BaseLayout
  lang="de"
  title="Jüngst gelesen"
  description="Die Bücher, die ich zuletzt gelesen habe."
>
  <h2 class="text-xl underline underline-offset-2 clear-descenders z-10 mb-2">
    Jüngst gelesen
  </h2>
  <ul class="grid gap-4">
    {
      books.map(({ data, id }: BookPostType) => (
        <BookListItem
          id={id}
          title={data.title}
          subtitle={data.subtitle}
          authors={data.authors}
          genre={data.genre}
          releaseDate={data.releaseDate}
        />
      ))
    }
  </ul>
</BaseLayout>

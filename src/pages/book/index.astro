---
import { getCollection } from "astro:content";
import type { BookPostType } from "./[...slug].astro";
import BaseLayout from "../../layouts/BaseLayout.astro";
import BookListItem from "../../components/list-item/BookListItem.astro";

const books: BookPostType[] = (await getCollection("book"))
  .filter(({ data }: BookPostType) => !data.draft && data.finishedDate)
  .sort(
    (a: BookPostType, b: BookPostType) =>
      a.data.finishedDate!.valueOf() - b.data.finishedDate!.valueOf(),
  )
  .reverse();
---

<BaseLayout
  lang="de"
  title="Jüngst gelesen"
  description="Die Bücher, die ich zuletzt gelesen habe."
>
  <h2 class="text-xl underline underline-offset-2 clear-descenders z-10 mb-2">
    Jüngst gelesen
  </h2>
  <ul class="grid gap-4">
    {books.map((book: BookPostType) => <BookListItem {...book} />)}
  </ul>
</BaseLayout>
